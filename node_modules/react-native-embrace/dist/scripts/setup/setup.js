"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const logger_1 = require("../../src/logger");
const wizard_1 = require("../util/wizard");
const android_1 = require("./android");
const common_1 = require("./common");
const ios_1 = require("./ios");
const logger = new logger_1.default(console);
logger.log('initializing setup wizard');
const iosSetps = [
    ios_1.iosImportEmbrace,
    ios_1.iosInitializeEmbrace,
    ios_1.iosPodfile,
    ios_1.patchXcodeBundlePhase,
    ios_1.addUploadBuildPhase,
    ios_1.createEmbracePlist,
];
const androidSteps = [
    android_1.patchBuildGradle,
    android_1.patchAppBuildGradle,
    android_1.createEmbraceJSON,
    android_1.patchMainApplication,
];
const run = () => {
    const wiz = new wizard_1.default();
    [common_1.iosAppID, common_1.apiToken, common_1.packageJSON].map((field) => wiz.registerField(field));
    [
        ...iosSetps,
        ...androidSteps,
    ].map((step) => wiz.registerStep(step));
    wiz.runSteps().then(() => {
        logger.log('done');
    }).catch((err) => logger.error('error in setting up Embrace: ' + err));
};
exports.default = run;
